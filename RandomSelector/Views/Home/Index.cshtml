@using RandomSelector.Models.Param
@model RandomSelector.Models.ViewModel.IndexViewModel

@section main {
    @Html.ValidationSummary(false)
    @if (Model.IsPostRequest)
    {
        <table class="table table-condensed" style="margin-bottom: 10px;">
            <tr>
                <th colspan="4">王国カード</th>
            </tr>

            @foreach (var card in Model.GetUseKingdomListAddDisaster().OrderBy(x => x.ExpansionID).ThenBy(x => x.SortOrder).ThenBy(x => x.NameKana))
            {
                <tr class="expansion@(card.ExpansionID.ToString("D"))">
                    <td class="col-xs-3">@card.ExpansionID.ToDisplayName()</td>
                    <td class="col-xs-1">@card.DisplayCost</td>
                    <td class="col-xs-7">@card.Name</td>
                    <td class="col-xs-1">@card.Remark</td>
                </tr>
            }

            @if (Model.UseNotKingdomCardList.Any())
            {
                <tr>
                    <th colspan="4">イベント・ランドマーク</th>
                </tr>
                foreach (var card in Model.UseNotKingdomCardList.OrderBy(x => x.ExpansionID).ThenBy(x => x.SortOrder).ThenBy(x => x.NameKana))
                {
                    <tr class="expansion@(card.ExpansionID.ToString("D"))">
                        <td>@card.ExpansionID.ToDisplayName()</td>
                        <td>@card.DisplayCost</td>
                        <td>@card.Name</td>
                        <td>@(card.Type == CardType.Event ? Const.RemarkEvent : Const.RemarkLandMark)</td>
                    </tr>
                    if (card.CardID == Const.ObeliskCardID)
                    {
                        <tr>
                            <td colspan="4" style="color:gray; font-size:10pt;">（※対象サプライ：@Model.GetObeliskTargetSuuplyCardName()）</td>
                        </tr>
                    }
                }
            }

            @if (Model.DarkMarketCardList != null && Model.DarkMarketCardList.Any())
            {
                <tr>
                    <th colspan="4">闇市場デッキ</th>
                </tr>
                foreach (var card in Model.DarkMarketCardList.OrderBy(x => x.ExpansionID).ThenBy(x => x.SortOrder).ThenBy(x => x.NameKana))
                {
                    <tr class="expansion@(card.ExpansionID.ToString("D"))">
                        <td>@card.ExpansionID.ToDisplayName()</td>
                        <td>@card.DisplayCost</td>
                        <td colspan="2">@card.Name</td>
                    </tr>
                }
            }
        </table>
        <div id="itemArea" class="optionItem">
            <button class="btn btn-xs @(Model.IsUseColony ? "btn-success" : "btn-default")" disabled="@(!Model.IsUseColony)">白金貨・植民地</button>
            <button class="btn btn-xs @(Model.IsUseShelter ? "btn-success" : "btn-default")" disabled="@(!Model.IsUseShelter)">避難所</button>
            @foreach (var item in EnumUtil.GetDisplayValuea<ItemCode>())
            {
                var isUse = Model.IsUseItem(item);
                <button class="btn btn-xs @(isUse ? "btn-success" : "btn-default")" disabled="@(!isUse)">@item.ToDisplayName()</button>
            }
        </div>
        if (Model.Param.ExpansionIDList.Contains(ExpansionID.Nocturne))
        {
            <div id="heirloomArea" class="optionItem">
                @foreach (var item in EnumUtil.GetDisplayValuea<Heirloom>().OrderBy(x => x))
                {
                    <button class="btn btn-xs @(Model.UseHeirlooms.Contains(item) ? "btn-success" : "btn-default")" disabled="@(!Model.UseHeirlooms.Contains(item))">@item.ToDisplayName()</button>
                }
            </div>
        }
    }

    @using (Html.BeginForm())
    {
        <hr />
        <input type="submit" class="btn btn-primary btn-block btn-lg center-block" value="実行" />
        <div class="form-group" id="expantionArea">
            @foreach (var expansion in EnumUtil.GetDisplayValuea<ExpansionID>().OrderBy(x => x))
            {
                <div class="checkbox">
                    <label>
                        <input type="checkbox" id="@(nameof(IndexParam.ExpansionIDList) + "_" + expansion.ToString("D"))" name="@nameof(IndexParam.ExpansionIDList)" value="@expansion" checked="@Model.Param.ExpansionIDList.Contains(expansion)" />
                        @expansion.ToDisplayName()
                    </label>
                </div>
            }
            <div id="promCard" class="col-xs-offset-1" style="@(Model.Param.ExpansionIDList.Any(x => x == ExpansionID.Promotion) ? "" : "display:none;")">
                @foreach (var prom in Model.PromCardList)
                {
                    <div class="checkbox">
                        <label>
                            <input type="checkbox" name="@nameof(IndexParam.SelectedPromCardID)" value="@prom.CardID" checked="@Model.Param.SelectedPromCardID.Contains(prom.CardID)" />
                            @prom.Name
                        </label>
                    </div>
                }
            </div>
        </div>
        <h3>【詳細設定】</h3>
        <div class="form-group" id="detailSettings">
            <div class="checkbox">
                <label>
                    <input type="checkbox" id="@nameof(IndexParam.IsWeightingAlchemy)" name="@nameof(IndexParam.IsWeightingAlchemy)" value="true" checked="@Model.Param.IsWeightingAlchemy" />
                    錬金術の重み付けを行う
                </label>
            </div>
        </div>
    }
}

@section footerJS {
    <script src="~/Scripts/RandomSelector.js"></script>
}
